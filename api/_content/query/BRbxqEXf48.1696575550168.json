{"_path":"/docs/craftform/api_behaviour","_dir":"craftform","_draft":false,"_partial":false,"_locale":"","title":"behaviour","description":"Craftform API","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"behaviour"},"children":[{"type":"text","value":"behaviour"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Craftform API"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sample data :"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"{craft_id} = frozen.temp.mes_ordre_inter.base.craftform"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"{session_path} = craft/{craft_id} = craft/frozen.temp.mes_ordre_inter.base.craftform"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"GET {FRONTEND}/craft/{craft_id}"}]},{"type":"text","value":" main craft page"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"GET {BACKEND}/api/craftform/{craft_id}"}]},{"type":"text","value":" get craft def"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"POST {BACKEND}/api/craft/file/{craft_id}"}]},{"type":"text","value":" call on a file drop"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"POST {BACKEND}/api/craft/{craft_id}"}]},{"type":"text","value":" generate PDF (preview or finalize)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"GET /api/files/session/{session_path}"}]},{"type":"text","value":" get user session files"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"DELETE /api/files/session/{session_path}"}]},{"type":"text","value":" delete user session files"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"GET {BACKEND}/api/craft/{craft_id}/output.pdf"}]},{"type":"text","value":" the generated PDF file"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Main craftform behaviour"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"user "},{"type":"element","tag":"a","props":{"href":"#change_behaviour"},"children":[{"type":"text","value":"change"}]},{"type":"text","value":" an input field"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"user "},{"type":"element","tag":"a","props":{"href":"#upload_behaviour"},"children":[{"type":"text","value":"upload"}]},{"type":"text","value":" a file"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"user "},{"type":"element","tag":"a","props":{"href":"#preview_behaviour"},"children":[{"type":"text","value":"preview"}]},{"type":"text","value":" the generated PDF"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"user "},{"type":"element","tag":"a","props":{"href":"#finalize_behaviour"},"children":[{"type":"text","value":"finalize"}]},{"type":"text","value":" the generated PDF"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"user "},{"type":"element","tag":"a","props":{"href":"#reset_behaviour"},"children":[{"type":"text","value":"reset"}]},{"type":"text","value":" the form"}]}]},{"type":"element","tag":"h2","props":{"id":"change_behaviour"},"children":[{"type":"text","value":"change_behaviour"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"user change a field and leave focus on this field"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"..."}]}]},{"type":"element","tag":"h2","props":{"id":"upload_behaviour"},"children":[{"type":"text","value":"upload_behaviour"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"user drop a file on the form drop zone "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"<ppw-dropfile-main2>"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"POST {BACKEND}/api/craft/file/{craft_id}"}]},{"type":"text","value":" called\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"lib.file_post()"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"ctx.script_exec(.. \"drop_file\" ..)"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"session.store_fileobj()"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"form_data_store()"}]}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"FRONTEND:onFileChange()"}]},{"type":"text","value":" called"}]}]},{"type":"element","tag":"h2","props":{"id":"preview_behaviour"},"children":[{"type":"text","value":"preview_behaviour"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"user click the preview button"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"FRONTEND:doPreview()"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"FRONTEND:generateDocument()"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"POST {BACKEND}/api/craft/{craft_id}"}]},{"type":"text","value":" generate PDF\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"lib.form_data_store(..)"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"tools.generate_files()"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"with tempfile ..."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"tools2.CraftContext()"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"tools2.grab_context_from_storage_to_local_temp()"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"process_dropped_files()"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"ctx.script_exec(.. \"drop_file_pdf\" ..)"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"ctx.script_exec(.. \"drop_file_excel\" ..)"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"ctx.script_exec(.. \"template_get\" ..)"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"ctx.script_exec(.. \"generate_pdf\" ..)"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"generate_pdf_post()"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"ctx.script_exec(.. \"generate_metadata\" ..)"}]},{"type":"text","value":" (optional)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"generate_metadata_post()"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"if finalize:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"ctx.script_exec(.. \"generate_signature\" ..)"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"generate_signature_post()"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"session.store_fileobj()"}]}]}]}]}]}]}]}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":".. open preview dialog ?"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"GET {BACKEND}/api/craft/{craft_id}/output.pdf"}]},{"type":"text","value":" the generated PDF file"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"finalize_behaviour"},"children":[{"type":"text","value":"finalize_behaviour"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Same as preview_behaviour."}]},{"type":"element","tag":"h2","props":{"id":"reset_behaviour"},"children":[{"type":"text","value":"reset_behaviour"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"change_behaviour","depth":2,"text":"change_behaviour"},{"id":"upload_behaviour","depth":2,"text":"upload_behaviour"},{"id":"preview_behaviour","depth":2,"text":"preview_behaviour"},{"id":"finalize_behaviour","depth":2,"text":"finalize_behaviour"},{"id":"reset_behaviour","depth":2,"text":"reset_behaviour"}]}},"_type":"markdown","_id":"content:10.docs:30.craftform:api_behaviour.md","_source":"content","_file":"10.docs/30.craftform/api_behaviour.md","_extension":"md"}